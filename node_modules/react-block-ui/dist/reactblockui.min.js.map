{"version":3,"file":"reactblockui.min.js","sources":["../src/safeActiveElement.js","../src/BlockUi.js","../src/Loader.js"],"sourcesContent":["// https://gist.github.com/Alex1990/046a6553dc83e22dd6f4\n/**\n * Get the current active element safely.\n * Ref: https://github.com/jquery/jquery-ui/blob/2b84531ae9331f60e4d739fabca6d78abde89ae1/ui/safe-active-element.js\n */\nexport default function safeActiveElement(doc) {\n  doc = doc || document;\n  let activeElement;\n\n  try {\n    activeElement = document.activeElement;\n    if (!activeElement || !activeElement.nodeName) {\n      activeElement = doc.body;\n    }\n  } catch ( error ) {\n    activeElement = doc.body;\n  }\n\n  return activeElement;\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport DefaultLoader from './Loader';\nimport safeActiveElement from './safeActiveElement';\n\nconst defaultProps = {\n  tag: 'div',\n  renderChildren: true,\n  loader: DefaultLoader,\n};\n\nclass BlockUi extends Component {\n  constructor(props) {\n    super(props);\n\n    this.tabbedUpTop = this.tabbedUpTop.bind(this);\n    this.tabbedDownTop = this.tabbedDownTop.bind(this);\n    this.tabbedUpBottom = this.tabbedUpBottom.bind(this);\n    this.tabbedDownBottom = this.tabbedDownBottom.bind(this);\n    this.setHelper = this.setRef.bind(this, 'helper');\n    this.setBlocker = this.setRef.bind(this, 'blocker');\n    this.setTopFocus = this.setRef.bind(this, 'topFocus');\n    this.setContainer = this.setRef.bind(this, 'container');\n    this.setMessageContainer = this.setRef.bind(this, 'messageContainer');\n    this.handleScroll = this.handleScroll.bind(this);\n\n    this.state = { top: '50%' };\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.blocking !== this.props.blocking) {\n      if (nextProps.blocking) {\n        // blocking started\n        if (this.helper && this.helper.parentNode && this.helper.parentNode.contains\n          && this.helper.parentNode.contains(safeActiveElement())) {\n          this.focused = safeActiveElement();\n          // https://www.tjvantoll.com/2013/08/30/bugs-with-document-activeelement-in-internet-explorer/#blurring-the-body-switches-windows-in-ie9-and-ie10\n          if (this.focused && this.focused !== document.body) {\n            (window.setImmediate || setTimeout)(() => this.focused && typeof this.focused.blur === 'function' && this.focused.blur());\n          }\n        }\n      } else {\n        this.detachListeners();\n        const ae = safeActiveElement();\n        if (this.focused && (!ae || ae === document.body || ae === this.topFocus)) {\n          if (typeof this.focused.focus === 'function') {\n            this.focused.focus();\n          }\n          this.focused = null;\n        }\n      }\n    }\n    if (nextProps.keepInView && (nextProps.keepInView !== this.props.keepInView || (nextProps.blocking && nextProps.blocking !== this.props.blocking))) {\n      this.attachListeners();\n      this.keepInView(nextProps);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachListeners();\n  }\n\n  setRef(name, ref) {\n    this[name] = ref;\n  }\n\n  attachListeners() {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n\n  detachListeners() {\n    window.removeEventListener('scroll', this.handleScroll);\n  }\n\n  blockingTab(e, withShift = false) {\n    // eslint-disable-next-line eqeqeq\n    return this.props.blocking && (e.key === 'Tab' || e.keyCode === 9) && e.shiftKey == withShift;\n  }\n\n  tabbedUpTop(e) {\n    if (this.blockingTab(e)) {\n      this.blocker.focus();\n    }\n  }\n\n  tabbedDownTop(e) {\n    if (this.blockingTab(e)) {\n      e.preventDefault();\n      this.blocker.focus();\n    }\n  }\n\n  tabbedUpBottom(e) {\n    if (this.blockingTab(e, true)) {\n      this.topFocus.focus();\n    }\n  }\n\n  tabbedDownBottom(e) {\n    if (this.blockingTab(e, true)) {\n      e.preventDefault();\n      this.topFocus.focus();\n    }\n  }\n\n  keepInView(props = this.props) {\n    if (props.blocking && props.keepInView && this.container) {\n      const containerBounds = this.container.getBoundingClientRect();\n      const windowHeight = window.innerHeight;\n      if (containerBounds.top > windowHeight || containerBounds.bottom < 0) return;\n      if (containerBounds.top >= 0 && containerBounds.bottom <= windowHeight) {\n        if (this.state.top !== '50%') {\n          this.setState({ top: '50%' });\n        }\n        return;\n      }\n\n      const messageBoundsHeight = this.messageContainer ? this.messageContainer.getBoundingClientRect().height : 0;\n      let top = Math.max(Math.min(windowHeight, containerBounds.bottom) - Math.max(containerBounds.top, 0), messageBoundsHeight) / 2;\n      if (containerBounds.top < 0) {\n        top = Math.min(top - containerBounds.top, containerBounds.height - (messageBoundsHeight / 2));\n      }\n      if (this.state.top !== top) {\n        this.setState({top});\n      }\n\n    }\n  }\n\n  handleScroll() {\n    this.keepInView();\n  }\n\n  render() {\n    const {\n      tag: Tag,\n      blocking,\n      className,\n      children,\n      message,\n      loader: Loader,\n      renderChildren,\n      keepInView,\n      ...attributes\n    } = this.props;\n\n    const classes = blocking ? `block-ui ${className}` : className;\n    const renderChilds = !blocking || renderChildren;\n\n    return (\n      <Tag {...attributes} className={classes} aria-busy={blocking}>\n        {blocking &&\n        <div tabIndex=\"0\" onKeyUp={this.tabbedUpTop} onKeyDown={this.tabbedDownTop} ref={this.setTopFocus} />}\n        {renderChilds && children}\n        {blocking &&\n        <div className=\"block-ui-container\"\n          tabIndex=\"0\"\n          ref={this.setBlocker}\n          onKeyUp={this.tabbedUpBottom}\n          onKeyDown={this.tabbedDownBottom}\n        >\n          <div className=\"block-ui-overlay\" ref={this.setContainer} />\n          <div className=\"block-ui-message-container\"\n            ref={this.setMessageContainer}\n            style={{ top: keepInView ? this.state.top : undefined }}\n          >\n            <div className=\"block-ui-message\">\n              {message}\n              {React.isValidElement(Loader) ? Loader : <Loader />}\n            </div>\n          </div>\n        </div>\n        }\n        <span ref={this.setHelper} />\n      </Tag>\n    );\n  }\n}\n\nBlockUi.propTypes = {\n  blocking: PropTypes.bool,\n  children: PropTypes.node,\n  renderChildren: PropTypes.bool,\n  keepInView: PropTypes.bool,\n  className: PropTypes.string,\n  message: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.node,\n  ]),\n  loader: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func,\n    PropTypes.node,\n  ]),\n  tag: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func,\n    PropTypes.shape({ $$typeof: PropTypes.symbol, render: PropTypes.func }),\n  ]),\n};\nBlockUi.defaultProps = defaultProps;\n\nexport default BlockUi;\n","import React from 'react';\n\nfunction Loader() {\n  return (\n    <div className=\"loading-indicator\">\n      <span className=\"loading-bullet\">&bull;</span>{' '}\n      <span className=\"loading-bullet\">&bull;</span>{' '}\n      <span className=\"loading-bullet\">&bull;</span>\n    </div>\n  );\n}\n\nexport default Loader;\n"],"names":["doc","document","activeElement","nodeName","body","BlockUi","tabbedUpTop","bind","tabbedDownTop","tabbedUpBottom","tabbedDownBottom","setHelper","setRef","setBlocker","setTopFocus","setContainer","setMessageContainer","handleScroll","state","top","nextProps","blocking","props","helper","parentNode","contains","safeActiveElement","focused","window","setImmediate","setTimeout","blur","detachListeners","ae","topFocus","focus","keepInView","attachListeners","addEventListener","removeEventListener","withShift","e","key","keyCode","shiftKey","blockingTab","blocker","preventDefault","Math","max","min","container","containerBounds","getBoundingClientRect","windowHeight","innerHeight","bottom","setState","messageBoundsHeight","messageContainer","height","Tag","tag","className","children","message","Loader","loader","renderChildren","attributes","classes","React","tabIndex","onKeyUp","onKeyDown","ref","isValidElement","Component","defaultProps"],"mappings":"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"}